python train_single_gpu.py \
  --train_path="../data/babycosmofine_10M_train_tokenized.bin" \
  --valid_path="../data/babycosmofine_10M_validation_tokenized.bin" \
  --name="test-run-delete" \
  --wandb_project="gpt-bert-sp-bpe" \
  --wandb_entity="rarese19-proiect" \
  --config_file="../configs/small.json" \
  --tokenizer_path="../tokenizers/tokenizer_10M.json" \
  --output_dir="../model_checkpoints" \
  --optimizer="lamb" \
  --hybrid_numerator=15 \
  --hybrid_denominator=16 \
  --seq_length=128 \
  --local_batch_size=256 \
  --global_batch_size=256 \
  --batch_reduction=4 \
  --learning_rate=1.41e-2 \
  --max_steps=7812 \
  --ema_decay=0.999 \
  --validate_every=1000 \
  --validation_steps=1 \
  --log_stats_every=100 \
  --save_every=1000 \
  --warmup_proportion=0.016 \
  --cooldown_proportion=0.016 \
  --mask_p_start=0.3 \
  --mask_p_end=0.15 \
  --mask_random_p=0.1 \
  --mask_keep_p=0.1 \
  --weight_decay=0.1 \
  --optimizer_eps=1e-8 \
  --optimizer_beta1=0.9 \
  --optimizer_beta2=0.98 \
  --max_gradient=2.0 \
  --mixed_precision \
  --seed=42 \
  --n_special_tokens=16 \
  --z_loss_weight=1e-4